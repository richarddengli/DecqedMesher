# DecqedMesher

[![Build Status](https://github.com/richarddengli/DecqedMesher/actions/workflows/CI.yml/badge.svg?branch=main)](https://github.com/richarddengli/DecqedMesher/actions/workflows/CI.yml?query=branch%3Amain)
[![Coverage](https://codecov.io/gh/richarddengli/DecqedMesher.jl/branch/main/graph/badge.svg)](https://codecov.io/gh/richarddengli/DecqedMesher.jl)


# DecqedMesher
A program for constructing primal and dual mesh objects to be used in discrete exterior calculus simulations. 

This work is done as part of the Undergraduate Research Internship at IBM and Princeton (QURIP). 

The main program itself is written in Julia, found at `/mesher3D`, while the drafts preceding the implementation of the program were written in Python notebooks, archived under `/gmsh_parser_jupyter_notebooks`. A supplementary program for 2D meshes is found at `/mesher2D`, which is almost the same as its 3D counterpart except minor differences.

# Installation
Make sure Git is configured on your workstation. Clone this repository by executing

`git clone git@github.com:richarddengli/dec-qed.git` (cloning via SSH)

or 

`git clone https://github.com/richarddengli/dec-qed.git` (cloning via HTTPS)

We recommend cloning via SSH key.

Next, navigate to the `/mesher3D` folder and make sure you have the latest version of `Julia` installed, as well as the packages listed in `mesher3D_requirements.jl`.

# Construct primal mesh
First, create an empty an empty `.jl` file, and run

`using .mesher3D_Dualmesh`

(Alternatively, write your code in the existing the existing `mesher3D_testing.jl` file, which already includes one line, `using .mesher3D_Dualmesh`).

Next, to construct the complete primal mesh representation of a primal meshing generated by Gmsh (whose information is contained in 
some `[file_name.msh]` file) execute the following line 

`primalmesh = complete_primalmesh(raw"/meshes/[file_name.msh]")`

replacing ```[file_name.msh]``` with the desired mesh file. We have assumed that this `.msh` file is located in the `/meshes` folder. 

(On Windows, may need to replace forwardslashes `/` with backslashes `\`.)

# Construct dual mesh

Likewise, the complete dual mesh representation of the same mesh is generated via

`dualmesh = complete_dualmesh(raw"/meshes/[file_name.msh]")`

# Accessing  mesh information & examples
Any desired information about the mesh & its objects can be easily accessed by retrieving the appropriate fields of the `struct`s and/or indexing into the appropriate `dict`s.

In the following, we use  `transfinite_test.msh` as an example Gmsh mesh.

First, execute

```
primalmesh = complete_primalmesh(raw"/meshes/transfinite_test.msh")`
dualmesh = complete_dualmesh(raw"/meshes/transfinite_test.msh")`
```

We find the primal nodes belonging to the primal tet whose `id` is 114, by executing

`primalmesh.tetdict[114].nodes`

The result is
```
julia> primalmesh.tetdict[114].nodes
4-element SVector{4, Int64} with indices SOneTo(4):
21
34
40
45
```

We can also find each of the auxiliary dual faces of the dual volume corresponding to the primal node whose `id` is 2, by executing

`dualmesh.dualvolumedict[2].auxiliary_dualfaces`

The result is
```
julia> dualmesh.dualvolumedict[2].auxiliary_dualfaces
6-element Vector{SVector{2, Any}}:
 [[2, 9, 23], 2]
 [[2, 19, 30], 2]
 [[2, 10, 23], 2]
 [[2, 9, 30], 2]
 [[2, 19, 44], 2]
 [[2, 10, 44], 2]
```

The user can inspect the hierarchical structure of any element in detail at `/types.jl`.

# Retrieving updates
Update to the latest version of the program by executing

`git pull git@github.com:richarddengli/dec-qed.git`

or 

`git pull https://github.com/richarddengli/dec-qed.git` 

depending on whether SSH or HTTPS was configured.

# Next steps
- implement plot.jl, which will allow for visualization
- complete the technical write-up
- complete example with Qiskit Metal
    - The test notebook, currently a work in progress, can be found on my local workstation at: /Users/RichardLi/Desktop/QURIP/qurip_code/qiskit-metal/tutorials/3 Renderers/Richard Test Notebook.ipynb
- time simulations

# Authors
Richard Li, Dzung Pham, Nick Bronn, Thomas McConkey, Olivia Lanes, Hakan Türeci

Türeci Group, Department of Electrical & Computer Engineering, Princeton University
<br>Qiskit Community Team, IBM Quantum

We also thank Abeer Vaishnav, Nathalie de Leon, Hwajung Kang, and the rest of the QURIP 2022 cohort for their support throughout the program. 

# Notes
- Semiclassical simulations: Modeling surface loss using DEC-QED, which factors in multiscale systems. Existing methods are classical or very basic. (Check martinis 2011 paper). Oxide layer at interface of substrate and metal is very small relative to other components of coplanar waveguide.
- Quantize EM field, i.e. fully quantum model. Need to first do the semiclassical mesh then quantize EM operators.
- incorporate with larger DEC-QED repo
- first get minimally working program then polish up stuff like modules

- Package generated using `PkgTemplates.jl`